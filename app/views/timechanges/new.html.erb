<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js"></script>

  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.min.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/js/bootstrap-datetimepicker.min.js"></script> 


 <div class="row"> 
    <div class="col-md-5 scheduler">
        <div class="container">

          <h1> Scheduler </h1>
          <h3>Daily updation time : <%= ModulsHelper.get_time %></h3>
          <br>
            <div style="position: relative">

              <%= form_tag :timechanges, action: "new" do %>
                  <%= text_field_tag :hours, "", class: "timepicker form-control", :placeholder => "Select Time to update DB"  %>
                  <%= submit_tag "Save changes", :class => "button" %>
              <% end  %>
            </div>
        </div>
    </div>

    <script type="text/javascript">
         $('.timepicker').datetimepicker({
              format: 'HH:mm'
          }); 
    </script>  

    <div class="col-md-5 dbupdate">
      
        <h1> Database updation </h1>
        <br><br>
        <h2 id="update"> <%#=ModulsHelper.ad%></h2>

        <div id="loader"> </div>
        <!-- button -->
        <%= button_to 'Update Now', button_path, method: :get ,remote: true  , :class =>"buttonload"  %> 
      </div>
    </div>


<style type="text/css">
  
   @import url('https://fonts.googleapis.com/css?family=Fira+Sans');

   h2{

    opacity: 0.5;

    margin-left: 50px;

   }



   #loader #up{
      
      margin-left: 130px;
      margin-top: -20px;
      width: 128px;
      height: 128px;


   }
   .buttonload{
    position: ;
    background-color: #003366;
    width: 250px;
    border-radius: 4px;
    border: none;
    color: white;
    margin-top: 35px;
    margin-left: 70px;
    padding: 7px 15px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;

   }

   .buttonload:hover{
     background-color: #0085aa; 
    border-radius: 4px;
    border: none;
    color: white;
   }
   .button {
    background-color: #003366;
    width: 250px;
    border-radius: 4px;
    border: none;
    color: white;
    margin-top: 35px;
    margin-left: 30px;
    padding: 7px 15px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
}

.button:hover {
    background-color: #0085aa; 
    border-radius: 4px;
    border: none;
    color: white;
    
}

h3{
  
   font-family: 'Fira Sans', sans-serif;
   font-size: 16px;
   margin-left: 55px; 
}

h1 {

  margin-left: 100px;
  margin-top: 130px;
    font-size: 22px;
    font-weight: bold;
   font-family: 'Fira Sans', sans-serif; 
}

.scheduler{

  margin-left: 150px;


}


..scheduler {

  margin-left: 150px;

  
}

.timepicker {

  width: 250px;

  margin-left: 30px;
}

</style>



<!-- ruby db checker -->


  
  <% begin %>
    <% a =  Sidekiqjob.last.end_progress %>
  <% rescue %>
    <% a = "nil"%>
  <% end %>





<!-- scripts -->

<!-- ajax script -->
<script type="text/javascript">
    function refresh() 
                { 
                  
                 $.ajax({
                        type: "GET",
                        url: "/but" ,
                        success: function(data){}
                        });
                  setTimeout(refresh, 250);
                }
    setTimeout(refresh, 10000);
</script>


<!-- rubyjs script -->

<% if  a == "completed"%>
  
  <script type="text/javascript">
    document.getElementsByTagName("input")[4].disabled = false;  
    console.log(document.getElementsByTagName("input")[4].value)
    console.log(document.getElementById("up"))

    if (document.getElementById("up") === null)
    {

    }
    else
    {
      var image_x = document.getElementById('up');
      image_x.parentNode.removeChild(image_x);
    }

    
  </script>

<%else%>

  <script type="text/javascript">
   document.getElementsByTagName("input")[4].disabled = true;
    document.getElementsByTagName("input")[4].value = "db updating please wait .... "

    var a =document.getElementById("update");
    a.innerHTML = ""
    var img = document.createElement("img");

    
  img.src = '<%= asset_path('12.gif') %>';
  img.setAttribute('id', "up")
  var src = document.getElementById("loader");
  src.appendChild(img);

   
  </script>

<%end%>







  
  <style type="text/css">
    .dropdown {
    position: relative;
    display: inline-block;
}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    padding: 12px 16px;
    z-index: 1;
}

.dropdown:hover .dropdown-content {
    display: block;
}
  </style>